{
  "security_audit": {
    "audit_date": "2025-08-14",
    "audit_version": "1.0",
    "application": "CA-66 Airport Use Agreement Generator",
    "overall_risk_level": "CRITICAL",
    "status": "ACTIVE_SECURITY_BREACH",
    "vulnerabilities": {
      "critical": {
        "count": 4,
        "items": [
          {
            "id": "CRIT-001",
            "title": "Exposed Gmail Credentials in Environment Files",
            "status": "ACTIVE",
            "risk_level": "CRITICAL",
            "locations": [".env", ".env.local", ".env.development.local"],
            "exposed_credentials": ["GMAIL_USER", "GMAIL_APP_PASSWORD"],
            "immediate_action_required": true
          },
          {
            "id": "CRIT-002", 
            "title": "Exposed Resend API Key",
            "status": "ACTIVE",
            "risk_level": "CRITICAL",
            "exposed_credentials": ["RESEND_API_KEY"],
            "immediate_action_required": true
          },
          {
            "id": "CRIT-003",
            "title": "Credentials Exposed in Background Process",
            "status": "ACTIVE",
            "risk_level": "CRITICAL",
            "process_details": "GMAIL_USER=theandykaufman@gmail.com GMAIL_APP_PASSWORD=qaiawjpvoivyhinh vercel dev --listen 3003",
            "immediate_action_required": true
          },
          {
            "id": "CRIT-004",
            "title": "Credentials in Configuration Files", 
            "status": "ACTIVE",
            "risk_level": "CRITICAL",
            "locations": [".claude/settings.local.json"],
            "immediate_action_required": true
          }
        ]
      },
      "high": {
        "count": 3,
        "items": [
          {
            "id": "HIGH-001",
            "title": "XSS via innerHTML Usage Without Sanitization",
            "status": "OPEN",
            "risk_level": "HIGH",
            "affected_files": ["app.js", "email-client.js", "generator.js"],
            "remediation_priority": "HIGH"
          },
          {
            "id": "HIGH-002",
            "title": "Insecure CORS Configuration",
            "status": "OPEN", 
            "risk_level": "HIGH",
            "location": "api/send-email.cjs:18",
            "remediation_priority": "HIGH"
          },
          {
            "id": "HIGH-003",
            "title": "Insufficient Input Validation in Email API",
            "status": "OPEN",
            "risk_level": "HIGH", 
            "location": "api/send-email.cjs",
            "remediation_priority": "HIGH"
          }
        ]
      },
      "medium": {
        "count": 6,
        "items": [
          {
            "id": "MED-001",
            "title": "Missing Content Security Policy (CSP)",
            "status": "OPEN",
            "risk_level": "MEDIUM"
          },
          {
            "id": "MED-002", 
            "title": "Sensitive Data in Error Messages",
            "status": "OPEN",
            "risk_level": "MEDIUM"
          },
          {
            "id": "MED-003",
            "title": "PDF Buffer Processing Without Size Limits",
            "status": "OPEN", 
            "risk_level": "MEDIUM"
          },
          {
            "id": "MED-004",
            "title": "Insecure Direct Object References",
            "status": "OPEN",
            "risk_level": "MEDIUM"
          },
          {
            "id": "MED-005",
            "title": "Missing Rate Limiting",
            "status": "OPEN",
            "risk_level": "MEDIUM"
          },
          {
            "id": "MED-006",
            "title": "Insufficient Logging and Monitoring", 
            "status": "OPEN",
            "risk_level": "MEDIUM"
          }
        ]
      },
      "low": {
        "count": 4,
        "items": [
          {
            "id": "LOW-001",
            "title": "Missing Security Headers",
            "status": "OPEN",
            "risk_level": "LOW"
          },
          {
            "id": "LOW-002",
            "title": "Dependency Vulnerabilities",
            "status": "OPEN", 
            "risk_level": "LOW"
          },
          {
            "id": "LOW-003",
            "title": "Debug Features in Production",
            "status": "OPEN",
            "risk_level": "LOW"
          },
          {
            "id": "LOW-004",
            "title": "Insufficient Session Management",
            "status": "OPEN",
            "risk_level": "LOW"
          }
        ]
      }
    },
    "exposed_credentials": {
      "gmail_user": "theandykaufman@gmail.com",
      "gmail_app_passwords": ["qaiawjpvoivyhinh", "jhrckruaujqiljbi"], 
      "resend_api_key": "re_5MQWFaMa_68kcufLhR2kjXDTy2DbYcVmU",
      "exposure_locations": [
        ".env",
        ".env.local", 
        ".env.development.local",
        ".claude/settings.local.json",
        "running_background_process"
      ],
      "credential_status": "COMPROMISED",
      "rotation_required": true,
      "rotation_urgency": "IMMEDIATE"
    },
    "remediation_timeline": {
      "immediate_24h": [
        "Stop running background process",
        "Rotate all exposed credentials",
        "Remove credentials from all files",
        "Store credentials in Vercel environment variables only"
      ],
      "short_term_1week": [
        "Fix XSS vulnerabilities",
        "Implement proper CORS configuration", 
        "Add input validation",
        "Implement CSP headers"
      ],
      "medium_term_1month": [
        "Add comprehensive logging",
        "Implement rate limiting",
        "Add security headers",
        "Automated security testing"
      ]
    },
    "compliance_status": {
      "owasp_top_10": "NON_COMPLIANT",
      "security_headers": "MISSING",
      "input_validation": "INSUFFICIENT",
      "access_control": "WEAK",
      "logging_monitoring": "INADEQUATE"
    },
    "next_audit_date": "2025-09-14",
    "emergency_response_required": true,
    "business_impact": "HIGH - Exposed credentials could lead to email compromise and data breach"
  }
}